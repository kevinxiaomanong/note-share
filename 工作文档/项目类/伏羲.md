### 背景

埋点对携程越来越重要了，要做千人千面的前提是你得足够了解你的用户，了解的一个重要途径是它在你的系统里留下的痕迹，从中来分析这个用户的特征和意向

所以埋点的质量很重要



这个平台建立的最初目的是想提高埋点的质量，保证你在伏羲建立的元数据信息和线上是一致的

在这个之上做了一些分析的功能



这个流程是和酒店一起共建的，保证这个元数据能最终反应到schema



### 1、元数据管理

埋点介绍：埋点无非是who、when、where、how、what去定义

对于who：携程这边分两种，uid对应一个账户、cid对应一台设备

when：事件发生时间、上报时间、类似Flink的两种时间语义、然后还有个时区的问题（上报时区）、unix时间戳

where：位置：IP/GPS

How：用什么设备 设备型号、OS等等 运营商

What：自定义参数，例如我搜一张北京-上海机票点搜索框，那么搜索框点击应该把票的时间、出发地这些信息给带上一起上报，所以这个是跟业务场景相关的



这些属于公参，框架自带的，每个埋点都应该有的



**时区的两大解决方案**

要么就是上报时区

或者使用unix时间戳，原理是时间戳生成的时候就会去掉时区的影响，传到另一个地方时再根据当地的区域加上时区的影响，时间戳是基于GMT的 不考虑时区的影响



**使用埋点数据的痛点**

埋点查找难，如果你作为BI，其实想知道前端的一个埋点情况的，如果去问不一定能问得到，或者去找json，但根本不知道field的含义

埋点参数不统一，所以需要

埋点参数版本混乱，不同版本不一样，需要绑定起来



SPM、参数管理、版本绑定来解决上述痛点



### 2、埋点发布流程

规范一套埋点发布流程，来保证你线上埋点的schema和在伏羲里注册的元数据匹配度高

BI出埋点方案---开发根据埋点



埋点验收



埋点监控

量级监控：同比、环比

参数监控：空值率、确实率

关联率监控：

智能监控



这里飞哥提到 用户画像标签监控 是用了这种方式

用户画像是一个很重要的服务



### 3、数据分析







### 4、数据分发













